# Work Log - 2026-02-08 (LineLanguageBot)

## Summary
- Added Note Tool boards + user settings APIs
- Added board card position updates and board card removal
- Added import existing card into board
- Updated schema migration for user settings JSONB
- Updated API documentation
- Added board list card counts
- Added boards tags support (DB + API)
- Added card link persistence from @ mentions

## Backend Changes
- Added `note_tool.users.settings` (JSONB) with migration helper in `init-db.js`
- Added `note_tool.boards.tags` (TEXT[]) with migration helper in `init-db.js`
- Added `note_tool/board` routes:
  - `GET /note_tool/board`
  - `POST /note_tool/board`
  - `GET /note_tool/board/:boardId`
  - `PUT /note_tool/board/:boardId` (tags[] supported)
  - `POST /note_tool/board/:boardId/cards` (create card in board)
  - `POST /note_tool/board/:boardId/cards/:cardId` (add existing card)
  - `PUT /note_tool/board/:boardId/cards/:cardId` (update x/y)
  - `DELETE /note_tool/board/:boardId/cards/:cardId` (remove from board)
- Card links (`note_tool.card_links`) updated on card save based on @ mentions
- Added user settings routes:
  - `GET /note_tool/user/settings`
  - `PUT /note_tool/user/settings`
- Restrict theme setting to `light` only (dark removed for now)
- `GET /note_tool/board` now returns `card_count` per board

## Files Touched
- `LineLanguageBot/index.js`
- `LineLanguageBot/scripts/init-db.js`
- `LineLanguageBot/services/note_tool/note_tool_user.js`
- `LineLanguageBot/services/note_tool/note_tool_board.js`
- `LineLanguageBot/services/note_tool/note_tool_card.js`
- `LineLanguageBot/routes/note_tool/board_routes.js`
- `LineLanguageBot/routes/note_tool/user_routes.js`
- `LineLanguageBot/docs/note_tool_api.md`
- `LineLanguageBot/README.md`

## Notes
- Restart backend after route changes
- `npm run initdb` only needed when adding new columns

## TODO (frontend)
1. 白板刪除功能
2. 卡片列表與白板內的摘要改為顯示 Markdown 編譯後的內容
